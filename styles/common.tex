
% -------------------------------------------------------
%  Common Styles and Formattings
% -------------------------------------------------------


\usepackage{amssymb,amsmath}
\usepackage[colorlinks,linkcolor=blue,citecolor=blue]{hyperref}
\usepackage[usenames,dvipsnames]{pstricks}
\usepackage{graphicx,subfigure,wrapfig}
\usepackage{geometry}
\usepackage[mathscr]{euscript}
\usepackage{multicol}
\usepackage{multirow}
\usepackage[figureposition=bottom,tableposition=top,font={small,bf},labelfont=bf]{caption}

\usepackage{algorithmicx,algorithm}

\usepackage[localise=on,extrafootnotefeatures]{xepersian}
\usepackage[noend]{algpseudocode}
\input{styles/alg-fa}


% -------------------- Page Layout --------------------


%\newgeometry{top=3cm,right=3cm,left=2.5cm,bottom=3cm,footskip=1.25cm}
\newgeometry{margin=1in,bottom=1.1in,footskip=.4in}

\renewcommand{\baselinestretch}{1.4}
\linespread{1.6}
\setlength{\parskip}{0.45em}

%\fancyhf{}
%\rhead{\leftmark}
%\lhead{\thepage}

\sloppy


% -------------------- Default Font --------------------

\settextfont[
Scale=1.09,
Extension=.ttf, 
Path=styles/fonts/,
BoldFont=XB NiloofarBd,
ItalicFont=XB NiloofarIt,
BoldItalicFont=XB NiloofarBdIt
]{XB Niloofar}

\setdigitfont[
Scale=1.09,
Extension=.ttf, 
Path=styles/fonts/,
BoldFont=XB NiloofarBd,
ItalicFont=XB NiloofarIt,
BoldItalicFont=XB NiloofarBdIt
]{XB Niloofar}


% -------------------- Sharif Font --------------------

\newcommand{\shariffont}{
\settextfont[
Scale=1.4,
Extension=.ttf, 
Path=styles/fonts/,
BoldFont=Sharif1.3-SemiBold,
]{Sharif1.3-Regular}

\setdigitfont[
Scale=1.4,
Extension=.ttf, 
Path=styles/fonts/,
BoldFont=Sharif1.3-SemiBold,
]{Sharif1.3-Regular}
}

% -------------------- Styles --------------------


\SepMark{-}
\renewcommand{\labelitemi}{$\small\bullet$}



% -------------------- Environments --------------------


\newtheorem{قضیه}{قضیه‌ی}[chapter]
\newtheorem{لم}[قضیه]{لم}
\newtheorem{ادعا}[قضیه]{ادعای}
\newtheorem{مشاهده}[قضیه]{مشاهده‌ی}
\newtheorem{نتیجه}[قضیه]{نتیجه‌ی}
\newtheorem{مسئله}{مسئله‌ی}[chapter]
\newtheorem{تعریف}{تعریف}[chapter]
\newtheorem{مثال}{مثال}[chapter]


\newenvironment{اثبات}
	{\begin{trivlist}\item[\hskip\labelsep{\em اثبات.}]}
	{\leavevmode\unskip\nobreak\quad\hspace*{\fill}{\ensuremath{{\square}}}\end{trivlist}}

\newenvironment{alg}[2]
	{\begin{latin}\settextfont[Scale=1.0]{Times New Roman}
	\begin{algorithm}[t]\caption{#1}\label{algo:#2}\vspace{0.2em}\begin{algorithmic}[1]}
	{\end{algorithmic}\vspace{0.2em}\end{algorithm}\end{latin}}


% -------------------- Titles --------------------


\renewcommand{\listfigurename}{فهرست شکل‌ها}
\renewcommand{\listtablename}{فهرست جدول‌ها}
\renewcommand{\bibname}{\rl{{مراجع}\hfill}} 


% -------------------- Commands --------------------


\newcommand{\IN}{\ensuremath{\mathbb{N}}} 
\newcommand{\IZ}{\ensuremath{\mathbb{Z}}} 
\newcommand{\IQ}{\ensuremath{\mathbb{Q}}} 
\newcommand{\IR}{\ensuremath{\mathbb{R}}} 
\newcommand{\IC}{\ensuremath{\mathbb{C}}} 

\newcommand{\set}[1]{\left\{ #1 \right\}}
\newcommand{\seq}[1]{\left< #1 \right>}
\newcommand{\ceil}[1]{\left\lceil{#1}\right\rceil}
\newcommand{\floor}[1]{\left\lfloor{#1}\right\rfloor}
\newcommand{\card}[1]{\left|{#1}\right|}
\newcommand{\setcomp}[1]{\overline{#1}}
\newcommand{\provided}{\,:\,}
\newcommand{\divs}{\mid}
\newcommand{\ndivs}{\nmid}
\newcommand{\iequiv}[1]{\,\overset{#1}{\equiv}\,}
\newcommand{\imod}[1]{\allowbreak\mkern5mu(#1\,\,\text{پیمانه‌ی})}

\newcommand{\poly}{\mathop{\mathrm{poly}}}
\newcommand{\polylog}{\mathop{\mathrm{polylog}}}
% \newcommand{\eps}{\varepsilon}

\newcommand{\lee}{\leqslant}
\newcommand{\gee}{\geqslant}
\renewcommand{\leq}{\lee}
\renewcommand{\le}{\lee}
\renewcommand{\geq}{\gee}
\renewcommand{\ge}{\gee}

\newcommand{\مهم}[1]{\textbf{#1}}
% \renewcommand{\برچسب}{\label}

\newcommand{\REM}[1]{}
% \renewcommand{\حذف}{\REM}
% \newcommand{\لر}{\lr}
\newcommand{\کد}[1]{\lr{\tt #1}}
\newcommand{\پاورقی}[1]{\footnote{\lr{#1}}}



% -------------------- Dictionary --------------------


\newcommand{\dicalphabet}[1]{
\begin{minipage}{\columnwidth}
	\centerline{\noindent\textbf{\large #1 }}
	\vspace{.5em}
\end{minipage}
\nopagebreak[4]
}

\newcommand{\dic}[2]{\noindent  #2 \dotfill  \lr{#1} \\ }


% ------------------------------ Images and Figures --------------------------

\graphicspath{{figs/}}
\setlength{\intextsep}{0pt}  % for float boxes
\renewcommand{\psscalebox}[1]{}  % for LaTeX Draw

\newcommand{\floatbox}[2]
	{\begin{wrapfigure}{l}{#1}
	\centering #2 \end{wrapfigure}}

\newcommand{\centerfig}[2]
	{\centering\scalebox{#2}{\input{figs/#1}}}

\newcommand{\fig}[3]
	{\floatbox{#3}{\centerfig{#1}{#2}}}

\newcommand{\centerimg}[2]
	{\vspace{1em}\begin{center}\includegraphics[width=#2]{figs/#1}\end{center}\vspace{-1.5em}}

\NewDocumentCommand{\img}{m m o}
	{\begin{wrapfigure}{l}{\IfValueTF{#3}{#3}{#2}}
	\centering\includegraphics[width=#2]{figs/#1}\end{wrapfigure}}



% -------------------- Custom Math Calligraphy --------------------

% -------------------- Custom Math Calligraphy (Auto-Math Mode) --------------------
% نیازمند بسته xparse است (که معمولاً با \NewDocumentCommand فراخوانی می‌شود)

% برای مکانیزم‌ها (Mechanisms)
% استفاده: \mech یا \mech[i]
\NewDocumentCommand{\mech}{o}{%
  \IfValueTF{#1}%
    {\ensuremath{\mathcal{M}_{#1}}}%  <-- حالت با آرگومان
    {\ensuremath{\mathcal{M}}}%     <-- حالت بدون آرگومان
}

% برای پایگاه داده یا دامنه (Datasets / Domain)
% استفاده: \Dset یا \Dset[1]
\NewDocumentCommand{\Dset}{o}{%
  \IfValueTF{#1}%
    {\ensuremath{\mathcal{D}_{#1}}}%
    {\ensuremath{\mathcal{D}}}%
}

% برای جهان داده‌ها (Data Universe)
% استفاده: \Xset
\NewDocumentCommand{\Xset}{o}{%
  \IfValueTF{#1}%
    {\ensuremath{\mathcal{X}_{#1}}}%
    {\ensuremath{\mathcal{X}}}%
}

% برای زیرمجموعه‌های خروجی (Subsets of Range)
% استفاده: \Sset
\NewDocumentCommand{\Sset}{o}{%
  \IfValueTF{#1}%
    {\ensuremath{\mathcal{S}_{#1}}}%
    {\ensuremath{\mathcal{S}}}%
}

% برای مجموعه‌ی پرس‌وجوها (Set of Queries)
% استفاده: \Qset
\NewDocumentCommand{\Qset}{o}{%
  \IfValueTF{#1}%
    {\ensuremath{\mathcal{Q}_{#1}}}%
    {\ensuremath{\mathcal{Q}}}%
}

% برای برد یا خروجی (Range / Output space)
% استفاده: \Rset
\NewDocumentCommand{\Rset}{o}{%
  \IfValueTF{#1}%
    {\ensuremath{\mathcal{R}_{#1}}}%
    {\ensuremath{\mathcal{R}}}%
}

\NewDocumentCommand{\Zset}{o}{%
  \IfValueTF{#1}%
    {\ensuremath{\mathcal{Z}_{#1}}}%
    {\ensuremath{\mathcal{Z}}}%
}

\NewDocumentCommand{\Eset}{o}{%
  \IfValueTF{#1}%
    {\ensuremath{\mathbb{E}_{#1}}}%
    {\ensuremath{\mathbb{E}}}%
}

% استفاده: \DP یا \DP[k\epsilon] یا \DP[(\epsilon, \delta)]
\NewDocumentCommand{\DP}{o}{%
  \IfValueTF{#1}%
    {\lr{\ensuremath{#1}-DP}}%  <-- حالت با آرگومان
    {\lr{$\eps$-DP}}%     <-- حالت بدون آرگومان (پیش‌فرض)
}

\NewDocumentCommand{\LDP}{o}{%
  \IfValueTF{#1}%
    {\lr{\ensuremath{#1}-LDP}}%  <-- حالت با آرگومان
    {\lr{\al-LDP}}%     <-- حالت بدون آرگومان (پیش‌فرض)
}

% تعریف دستور برای نرم (Norm)

\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\normo}[1]{\ensuremath{\left\lVert#1\right\rVert_1}}
\newcommand{\normt}[1]{\ensuremath{\left\lVert#1\right\rVert_2}}



% -------------------- حروف یونانی (حالت ریاضی خودکار) --------------------

% ----- حروف کوچک (با متغیرها) -----
\newcommand{\f}{\lr{$f$}}


% Alpha
\newcommand{\al}{\ensuremath{\alpha}}
% Beta
\newcommand{\bet}{\ensuremath{\beta}}
% Gamma
\newcommand{\gam}{\ensuremath{\gamma}}
% Delta
\newcommand{\del}{\ensuremath{\delta}}
% Epsilon
\newcommand{\ep}{\ensuremath{\epsilon}}
\newcommand{\eps}{\ensuremath{\varepsilon}} % <-- نسخه var
% Zeta
\newcommand{\ze}{\ensuremath{\zeta}}
% Eta
\newcommand{\et}{\ensuremath{\eta}}
% Theta
\newcommand{\thh}{\ensuremath{\theta}}
\newcommand{\vth}{\ensuremath{\vartheta}} % <-- نسخه var
% Iota
\newcommand{\io}{\ensuremath{\iota}}
% Kappa
\newcommand{\ka}{\ensuremath{\kappa}}
% Lambda
\newcommand{\lam}{\ensuremath{\lambda}}
% Mu
\newcommand{\muu}{\ensuremath{\mu}}
% Nu
\newcommand{\nuu}{\ensuremath{\nu}}
% Xi
\newcommand{\xii}{\ensuremath{\xi}}
% Pi
\newcommand{\pii}{\ensuremath{\pi}}
\newcommand{\vpi}{\ensuremath{\varpi}} % <-- نسخه var
% Rho
\newcommand{\rh}{\ensuremath{\rho}}
\newcommand{\vrh}{\ensuremath{\varrho}} % <-- نسخه var
% Sigma
\newcommand{\sig}{\ensuremath{\sigma}}
\newcommand{\vsig}{\ensuremath{\varsigma}} % <-- نسخه var
% Tau
\newcommand{\ta}{\ensuremath{\tau}}
% Upsilon
\newcommand{\up}{\ensuremath{\upsilon}}
% Phi
\newcommand{\ph}{\ensuremath{\phi}}
\newcommand{\vph}{\ensuremath{\varphi}} % <-- نسخه var
% Chi
\newcommand{\ch}{\ensuremath{\chi}}
% Psi
\newcommand{\ps}{\ensuremath{\psi}}
% Omega
\newcommand{\om}{\ensuremath{\omega}}

% ----- حروف بزرگ -----
\newcommand{\Gam}{\ensuremath{\Gamma}}
\newcommand{\Del}{\ensuremath{\Delta}}
\newcommand{\Thh}{\ensuremath{\Theta}}
\newcommand{\Lam}{\ensuremath{\Lambda}}
\newcommand{\Xii}{\ensuremath{\Xi}}
\newcommand{\Pii}{\ensuremath{\Pi}}
\newcommand{\Sig}{\ensuremath{\Sigma}}
\newcommand{\Up}{\ensuremath{\Upsilon}}
\newcommand{\Ph}{\ensuremath{\Phi}}
\newcommand{\Ps}{\ensuremath{\Psi}}
\newcommand{\Om}{\ensuremath{\Omega}}